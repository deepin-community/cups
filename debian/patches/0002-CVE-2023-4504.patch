From 61ecf34f141cf792814717d7a102f512920c734c Mon Sep 17 00:00:00 2001
From: Thorsten Alteholz <debian@alteholz.de>
Date: Wed, 20 Sep 2023 04:55:44 +0200
Subject: [PATCH] CVE-2023-4504

Change-Id: I6bd8eef98676057722d9b35e58045642b491431d
---
 cups/raster-interpret.c | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/cups/raster-interpret.c b/cups/raster-interpret.c
index 8727ad576..473d73367 100644
--- a/cups/raster-interpret.c
+++ b/cups/raster-interpret.c
@@ -1115,7 +1115,19 @@ scan_ps(_cups_ps_stack_t *st,		/* I  - Stack */
 
 	    cur ++;
 
-            if (*cur == 'b')
+	   /*
+	    * Return NULL if we reached NULL terminator, a lone backslash
+            * is not a valid character in PostScript.
+	    */
+
+	    if (!*cur)
+	    {
+	      *ptr = NULL;
+
+	      return (NULL);
+	    }
+
+	    if (*cur == 'b')
 	      *valptr++ = '\b';
 	    else if (*cur == 'f')
 	      *valptr++ = '\f';
-- 
2.20.1

